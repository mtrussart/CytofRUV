<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to CytofRUV</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to CytofRUV</h1>



<div id="introduction-to-cytofruv" class="section level1">
<h1>Introduction to CytofRUV</h1>
<p>CytofRUV is a computational algorithm which permits the integration of data across CyTOF batches. We provided an introduction here that explains step by step how to load and normalise datasets and also how to visualise the diagnostic plots using the R-Shiny application before and after CytofRUV normalisation.</p>
<div id="setup" class="section level2">
<h2>Setup</h2>
<p>We provided an example of a set of data that included all .fcs, a metadata file a and panel file in the inst/extdata. First of all we need to load all the packages.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(CytofRUV)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(CATALYST)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; Loading required package: SingleCellExperiment</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; Loading required package: SummarizedExperiment</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; Loading required package: GenomicRanges</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; Loading required package: stats4</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; Loading required package: BiocGenerics</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; Loading required package: parallel</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; Attaching package: 'BiocGenerics'</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt; The following objects are masked from 'package:parallel':</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt;     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt;     clusterExport, clusterMap, parApply, parCapply, parLapply,</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt;     parLapplyLB, parRapply, parSapply, parSapplyLB</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#&gt;     IQR, mad, sd, var, xtabs</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt;     anyDuplicated, append, as.data.frame, basename, cbind, colnames,</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt;     dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">#&gt;     grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co">#&gt;     order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="co">#&gt;     rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="co">#&gt;     union, unique, unsplit, which, which.max, which.min</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">#&gt; Loading required package: S4Vectors</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co">#&gt; Attaching package: 'S4Vectors'</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="co">#&gt; The following object is masked from 'package:base':</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-32" data-line-number="32"><span class="co">#&gt;     expand.grid</span></a>
<a class="sourceLine" id="cb1-33" data-line-number="33"><span class="co">#&gt; Loading required package: IRanges</span></a>
<a class="sourceLine" id="cb1-34" data-line-number="34"><span class="co">#&gt; Loading required package: GenomeInfoDb</span></a>
<a class="sourceLine" id="cb1-35" data-line-number="35"><span class="co">#&gt; Loading required package: Biobase</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36"><span class="co">#&gt; Welcome to Bioconductor</span></a>
<a class="sourceLine" id="cb1-37" data-line-number="37"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-38" data-line-number="38"><span class="co">#&gt;     Vignettes contain introductory material; view with</span></a>
<a class="sourceLine" id="cb1-39" data-line-number="39"><span class="co">#&gt;     'browseVignettes()'. To cite Bioconductor, see</span></a>
<a class="sourceLine" id="cb1-40" data-line-number="40"><span class="co">#&gt;     'citation(&quot;Biobase&quot;)', and for packages 'citation(&quot;pkgname&quot;)'.</span></a>
<a class="sourceLine" id="cb1-41" data-line-number="41"><span class="co">#&gt; Loading required package: DelayedArray</span></a>
<a class="sourceLine" id="cb1-42" data-line-number="42"><span class="co">#&gt; Loading required package: matrixStats</span></a>
<a class="sourceLine" id="cb1-43" data-line-number="43"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-44" data-line-number="44"><span class="co">#&gt; Attaching package: 'matrixStats'</span></a>
<a class="sourceLine" id="cb1-45" data-line-number="45"><span class="co">#&gt; The following objects are masked from 'package:Biobase':</span></a>
<a class="sourceLine" id="cb1-46" data-line-number="46"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-47" data-line-number="47"><span class="co">#&gt;     anyMissing, rowMedians</span></a>
<a class="sourceLine" id="cb1-48" data-line-number="48"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-49" data-line-number="49"><span class="co">#&gt; Attaching package: 'DelayedArray'</span></a>
<a class="sourceLine" id="cb1-50" data-line-number="50"><span class="co">#&gt; The following objects are masked from 'package:matrixStats':</span></a>
<a class="sourceLine" id="cb1-51" data-line-number="51"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-52" data-line-number="52"><span class="co">#&gt;     colMaxs, colMins, colRanges, rowMaxs, rowMins, rowRanges</span></a>
<a class="sourceLine" id="cb1-53" data-line-number="53"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb1-54" data-line-number="54"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-55" data-line-number="55"><span class="co">#&gt;     aperm, apply, rowsum</span></a>
<a class="sourceLine" id="cb1-56" data-line-number="56"><span class="kw">library</span>(flowCore)</a>
<a class="sourceLine" id="cb1-57" data-line-number="57"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-58" data-line-number="58"><span class="co">#&gt; Attaching package: 'flowCore'</span></a>
<a class="sourceLine" id="cb1-59" data-line-number="59"><span class="co">#&gt; The following object is masked from 'package:BiocGenerics':</span></a>
<a class="sourceLine" id="cb1-60" data-line-number="60"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-61" data-line-number="61"><span class="co">#&gt;     normalize</span></a>
<a class="sourceLine" id="cb1-62" data-line-number="62"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-63" data-line-number="63"><span class="kw">library</span>(readxl)</a>
<a class="sourceLine" id="cb1-64" data-line-number="64"><span class="kw">library</span>(ruv)</a>
<a class="sourceLine" id="cb1-65" data-line-number="65"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb1-66" data-line-number="66"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-67" data-line-number="67"><span class="co">#&gt; Attaching package: 'purrr'</span></a>
<a class="sourceLine" id="cb1-68" data-line-number="68"><span class="co">#&gt; The following object is masked from 'package:DelayedArray':</span></a>
<a class="sourceLine" id="cb1-69" data-line-number="69"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-70" data-line-number="70"><span class="co">#&gt;     simplify</span></a>
<a class="sourceLine" id="cb1-71" data-line-number="71"><span class="co">#&gt; The following object is masked from 'package:GenomicRanges':</span></a>
<a class="sourceLine" id="cb1-72" data-line-number="72"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-73" data-line-number="73"><span class="co">#&gt;     reduce</span></a>
<a class="sourceLine" id="cb1-74" data-line-number="74"><span class="co">#&gt; The following object is masked from 'package:IRanges':</span></a>
<a class="sourceLine" id="cb1-75" data-line-number="75"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-76" data-line-number="76"><span class="co">#&gt;     reduce</span></a>
<a class="sourceLine" id="cb1-77" data-line-number="77"><span class="kw">library</span>(FlowSOM)</a>
<a class="sourceLine" id="cb1-78" data-line-number="78"><span class="co">#&gt; Loading required package: igraph</span></a>
<a class="sourceLine" id="cb1-79" data-line-number="79"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-80" data-line-number="80"><span class="co">#&gt; Attaching package: 'igraph'</span></a>
<a class="sourceLine" id="cb1-81" data-line-number="81"><span class="co">#&gt; The following objects are masked from 'package:purrr':</span></a>
<a class="sourceLine" id="cb1-82" data-line-number="82"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-83" data-line-number="83"><span class="co">#&gt;     compose, simplify</span></a>
<a class="sourceLine" id="cb1-84" data-line-number="84"><span class="co">#&gt; The following object is masked from 'package:flowCore':</span></a>
<a class="sourceLine" id="cb1-85" data-line-number="85"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-86" data-line-number="86"><span class="co">#&gt;     normalize</span></a>
<a class="sourceLine" id="cb1-87" data-line-number="87"><span class="co">#&gt; The following objects are masked from 'package:DelayedArray':</span></a>
<a class="sourceLine" id="cb1-88" data-line-number="88"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-89" data-line-number="89"><span class="co">#&gt;     path, simplify</span></a>
<a class="sourceLine" id="cb1-90" data-line-number="90"><span class="co">#&gt; The following object is masked from 'package:GenomicRanges':</span></a>
<a class="sourceLine" id="cb1-91" data-line-number="91"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-92" data-line-number="92"><span class="co">#&gt;     union</span></a>
<a class="sourceLine" id="cb1-93" data-line-number="93"><span class="co">#&gt; The following object is masked from 'package:IRanges':</span></a>
<a class="sourceLine" id="cb1-94" data-line-number="94"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-95" data-line-number="95"><span class="co">#&gt;     union</span></a>
<a class="sourceLine" id="cb1-96" data-line-number="96"><span class="co">#&gt; The following object is masked from 'package:S4Vectors':</span></a>
<a class="sourceLine" id="cb1-97" data-line-number="97"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-98" data-line-number="98"><span class="co">#&gt;     union</span></a>
<a class="sourceLine" id="cb1-99" data-line-number="99"><span class="co">#&gt; The following objects are masked from 'package:BiocGenerics':</span></a>
<a class="sourceLine" id="cb1-100" data-line-number="100"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-101" data-line-number="101"><span class="co">#&gt;     normalize, path, union</span></a>
<a class="sourceLine" id="cb1-102" data-line-number="102"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb1-103" data-line-number="103"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-104" data-line-number="104"><span class="co">#&gt;     decompose, spectrum</span></a>
<a class="sourceLine" id="cb1-105" data-line-number="105"><span class="co">#&gt; The following object is masked from 'package:base':</span></a>
<a class="sourceLine" id="cb1-106" data-line-number="106"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-107" data-line-number="107"><span class="co">#&gt;     union</span></a>
<a class="sourceLine" id="cb1-108" data-line-number="108"><span class="kw">library</span>(SummarizedExperiment)</a>
<a class="sourceLine" id="cb1-109" data-line-number="109"><span class="kw">library</span>(ConsensusClusterPlus)</a>
<a class="sourceLine" id="cb1-110" data-line-number="110"><span class="kw">library</span>(SingleCellExperiment)</a>
<a class="sourceLine" id="cb1-111" data-line-number="111"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb1-112" data-line-number="112"><span class="kw">library</span>(shinyjs)</a>
<a class="sourceLine" id="cb1-113" data-line-number="113"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-114" data-line-number="114"><span class="co">#&gt; Attaching package: 'shinyjs'</span></a>
<a class="sourceLine" id="cb1-115" data-line-number="115"><span class="co">#&gt; The following object is masked from 'package:shiny':</span></a>
<a class="sourceLine" id="cb1-116" data-line-number="116"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-117" data-line-number="117"><span class="co">#&gt;     runExample</span></a>
<a class="sourceLine" id="cb1-118" data-line-number="118"><span class="co">#&gt; The following object is masked from 'package:flowCore':</span></a>
<a class="sourceLine" id="cb1-119" data-line-number="119"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-120" data-line-number="120"><span class="co">#&gt;     show</span></a>
<a class="sourceLine" id="cb1-121" data-line-number="121"><span class="co">#&gt; The following object is masked from 'package:SingleCellExperiment':</span></a>
<a class="sourceLine" id="cb1-122" data-line-number="122"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-123" data-line-number="123"><span class="co">#&gt;     show</span></a>
<a class="sourceLine" id="cb1-124" data-line-number="124"><span class="co">#&gt; The following object is masked from 'package:SummarizedExperiment':</span></a>
<a class="sourceLine" id="cb1-125" data-line-number="125"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-126" data-line-number="126"><span class="co">#&gt;     show</span></a>
<a class="sourceLine" id="cb1-127" data-line-number="127"><span class="co">#&gt; The following object is masked from 'package:DelayedArray':</span></a>
<a class="sourceLine" id="cb1-128" data-line-number="128"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-129" data-line-number="129"><span class="co">#&gt;     show</span></a>
<a class="sourceLine" id="cb1-130" data-line-number="130"><span class="co">#&gt; The following object is masked from 'package:Biobase':</span></a>
<a class="sourceLine" id="cb1-131" data-line-number="131"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-132" data-line-number="132"><span class="co">#&gt;     show</span></a>
<a class="sourceLine" id="cb1-133" data-line-number="133"><span class="co">#&gt; The following object is masked from 'package:GenomicRanges':</span></a>
<a class="sourceLine" id="cb1-134" data-line-number="134"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-135" data-line-number="135"><span class="co">#&gt;     show</span></a>
<a class="sourceLine" id="cb1-136" data-line-number="136"><span class="co">#&gt; The following object is masked from 'package:GenomeInfoDb':</span></a>
<a class="sourceLine" id="cb1-137" data-line-number="137"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-138" data-line-number="138"><span class="co">#&gt;     show</span></a>
<a class="sourceLine" id="cb1-139" data-line-number="139"><span class="co">#&gt; The following object is masked from 'package:IRanges':</span></a>
<a class="sourceLine" id="cb1-140" data-line-number="140"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-141" data-line-number="141"><span class="co">#&gt;     show</span></a>
<a class="sourceLine" id="cb1-142" data-line-number="142"><span class="co">#&gt; The following object is masked from 'package:S4Vectors':</span></a>
<a class="sourceLine" id="cb1-143" data-line-number="143"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-144" data-line-number="144"><span class="co">#&gt;     show</span></a>
<a class="sourceLine" id="cb1-145" data-line-number="145"><span class="co">#&gt; The following object is masked from 'package:stats4':</span></a>
<a class="sourceLine" id="cb1-146" data-line-number="146"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-147" data-line-number="147"><span class="co">#&gt;     show</span></a>
<a class="sourceLine" id="cb1-148" data-line-number="148"><span class="co">#&gt; The following objects are masked from 'package:methods':</span></a>
<a class="sourceLine" id="cb1-149" data-line-number="149"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-150" data-line-number="150"><span class="co">#&gt;     removeClass, show</span></a>
<a class="sourceLine" id="cb1-151" data-line-number="151"><span class="kw">library</span>(shinydashboard)</a>
<a class="sourceLine" id="cb1-152" data-line-number="152"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-153" data-line-number="153"><span class="co">#&gt; Attaching package: 'shinydashboard'</span></a>
<a class="sourceLine" id="cb1-154" data-line-number="154"><span class="co">#&gt; The following object is masked from 'package:graphics':</span></a>
<a class="sourceLine" id="cb1-155" data-line-number="155"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-156" data-line-number="156"><span class="co">#&gt;     box</span></a>
<a class="sourceLine" id="cb1-157" data-line-number="157"><span class="kw">library</span>(writexl)</a>
<a class="sourceLine" id="cb1-158" data-line-number="158"><span class="kw">library</span>(ComplexHeatmap)</a>
<a class="sourceLine" id="cb1-159" data-line-number="159"><span class="co">#&gt; Loading required package: grid</span></a>
<a class="sourceLine" id="cb1-160" data-line-number="160"><span class="co">#&gt; ========================================</span></a>
<a class="sourceLine" id="cb1-161" data-line-number="161"><span class="co">#&gt; ComplexHeatmap version 2.4.3</span></a>
<a class="sourceLine" id="cb1-162" data-line-number="162"><span class="co">#&gt; Bioconductor page: http://bioconductor.org/packages/ComplexHeatmap/</span></a>
<a class="sourceLine" id="cb1-163" data-line-number="163"><span class="co">#&gt; Github page: https://github.com/jokergoo/ComplexHeatmap</span></a>
<a class="sourceLine" id="cb1-164" data-line-number="164"><span class="co">#&gt; Documentation: http://jokergoo.github.io/ComplexHeatmap-reference</span></a>
<a class="sourceLine" id="cb1-165" data-line-number="165"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-166" data-line-number="166"><span class="co">#&gt; If you use it in published research, please cite:</span></a>
<a class="sourceLine" id="cb1-167" data-line-number="167"><span class="co">#&gt; Gu, Z. Complex heatmaps reveal patterns and correlations in multidimensional </span></a>
<a class="sourceLine" id="cb1-168" data-line-number="168"><span class="co">#&gt;   genomic data. Bioinformatics 2016.</span></a>
<a class="sourceLine" id="cb1-169" data-line-number="169"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-170" data-line-number="170"><span class="co">#&gt; This message can be suppressed by:</span></a>
<a class="sourceLine" id="cb1-171" data-line-number="171"><span class="co">#&gt;   suppressPackageStartupMessages(library(ComplexHeatmap))</span></a>
<a class="sourceLine" id="cb1-172" data-line-number="172"><span class="co">#&gt; ========================================</span></a>
<a class="sourceLine" id="cb1-173" data-line-number="173"><span class="kw">library</span>(shinycssloaders)</a></code></pre></div>
</div>
<div id="dataset" class="section level2">
<h2>Dataset</h2>
<p>Users are required to provide: the path to the fcs files from all the samples in the study, a metadata file containing the details of each sample and their respective .fcs files, and a panel file containing the details of all proteins used in the study. The metadata file is an excel file with the following column names: “file_name”, “sample_id”, “condition”, “patient_id”, “batch”. The panel file is an excel file with the following column names: “fcs_colname”, “antigen”, “marker_class”.</p>
<p>We provided an example dataset to help you prepare your data. The command below will load all the dataset including the metadata file, the panel file and the fcs files in the working directory.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">  output_dir=<span class="st">&quot;CytofRUV_output&quot;</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  <span class="cf">if</span> (<span class="op">!</span><span class="kw">dir.exists</span>(output_dir)){</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">    <span class="kw">dir.create</span>(output_dir)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  }</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  wd_data=<span class="kw">file.path</span>(<span class="kw">getwd</span>(),output_dir)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">  <span class="kw">write.FCS</span>(<span class="dt">x=</span>CytofRUV<span class="op">::</span>A1,<span class="dt">filename =</span><span class="kw">file.path</span>(wd_data,<span class="st">&quot;A1.fcs&quot;</span>))</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; [1] &quot;/Users/trussart.m/WEHI/R_Package/CytofRUV/vignettes/CytofRUV_output/A1.fcs&quot;</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8">  <span class="kw">write.FCS</span>(<span class="dt">x=</span>CytofRUV<span class="op">::</span>A2,<span class="dt">filename =</span> <span class="kw">file.path</span>(wd_data,<span class="st">&quot;A2.fcs&quot;</span>))</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; [1] &quot;/Users/trussart.m/WEHI/R_Package/CytofRUV/vignettes/CytofRUV_output/A2.fcs&quot;</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10">  <span class="kw">write.FCS</span>(<span class="dt">x=</span>CytofRUV<span class="op">::</span>Run3_A1,<span class="dt">filename =</span> <span class="kw">file.path</span>(wd_data,<span class="st">&quot;Run3_A1.fcs&quot;</span>))</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; [1] &quot;/Users/trussart.m/WEHI/R_Package/CytofRUV/vignettes/CytofRUV_output/Run3_A1.fcs&quot;</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12">  <span class="kw">write.FCS</span>(<span class="dt">x=</span>CytofRUV<span class="op">::</span>Run3_A2,<span class="dt">filename =</span> <span class="kw">file.path</span>(wd_data,<span class="st">&quot;Run3_A2.fcs&quot;</span>))</a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; [1] &quot;/Users/trussart.m/WEHI/R_Package/CytofRUV/vignettes/CytofRUV_output/Run3_A2.fcs&quot;</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14">  <span class="kw">write_xlsx</span>(<span class="dt">x=</span>CytofRUV<span class="op">::</span>md,<span class="dt">path =</span> <span class="kw">file.path</span>(wd_data,<span class="st">&quot;Metadata.xlsx&quot;</span>))</a>
<a class="sourceLine" id="cb2-15" data-line-number="15">  <span class="kw">write_xlsx</span>(<span class="dt">x=</span>CytofRUV<span class="op">::</span>panel,<span class="dt">path =</span> <span class="kw">file.path</span>(wd_data,<span class="st">&quot;Panel.xlsx&quot;</span>))</a></code></pre></div>
</div>
<div id="loading-datasets-and-clustering" class="section level2">
<h2>Loading datasets and clustering</h2>
<p>The first step is to load the metadata file, all the .fcs files, the panel file from the dataset. The user needs to define the working directory as well as the filename of the metadata file and the panel file. Once the dataset is loaded, after applying an arcsinh transformation (cofactor 5), all the data will be clustered. The user needs to provide the number of clusters to be used for this dataset.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">  <span class="co">## Define parameters to load and cluster the data</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  output_dir=<span class="st">&quot;CytofRUV_output&quot;</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  <span class="cf">if</span> (<span class="op">!</span><span class="kw">dir.exists</span>(output_dir)){</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">    <span class="kw">dir.create</span>(output_dir)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  }</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  wd_data=<span class="kw">file.path</span>(<span class="kw">getwd</span>(),output_dir)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  metadata_filename=<span class="st">&quot;Metadata.xlsx&quot;</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  panel_filename=<span class="st">&quot;Panel.xlsx&quot;</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  seed=<span class="dv">1234</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10">  clusters_nb=<span class="dv">20</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"></a>
<a class="sourceLine" id="cb3-12" data-line-number="12">  <span class="co">## Loading the data</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13">  data=<span class="kw">load_data</span>(wd_data,metadata_filename,panel_filename)</a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; [1] &quot;Reading MetaData&quot;</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; [1] &quot;Reading fcs files&quot;</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt;              name             desc    range minRange maxRange</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt; $P1          Time             &lt;NA&gt; 15248628        0 15248627</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt; $P2  Event_length             &lt;NA&gt;       94        0       93</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt; $P3         Y89Di         89Y_CD45     2410        0     2409</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt; $P4       Pd102Di    102Pd_Barcode    20694        0    20693</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt; $P5       Pd104Di    104Pd_Barcode    24736        0    24735</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt; $P6       Pd105Di    105Pd_Barcode    24619        0    24618</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt; $P7       Pd106Di    106Pd_Barcode    20195        0    20194</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt; $P8       Pd108Di    108Pd_Barcode    23303        0    23302</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt; $P9       Pd110Di    110Pd_Barcode    20908        0    20907</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt; $P10      In115Di     115In_HLA-DR     4659        0     4658</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="co">#&gt; $P11      La139Di            139La    17653        0    17652</span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="co">#&gt; $P12      Ce140Di 140Ce_CD27_MT271    23401        0    23400</span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="co">#&gt; $P13      Pr141Di    141Pr_CD235ab    20716        0    20715</span></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="co">#&gt; $P14      Nd142Di       142Nd_CD19    12575        0    12574</span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="co">#&gt; $P15      Nd143Di        143Nd_CD5    13286        0    13285</span></a>
<a class="sourceLine" id="cb3-32" data-line-number="32"><span class="co">#&gt; $P16      Nd144Di       144Nd_CD38     4375        0     4374</span></a>
<a class="sourceLine" id="cb3-33" data-line-number="33"><span class="co">#&gt; $P17      Nd145Di        145Nd_CD4     1661        0     1660</span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34"><span class="co">#&gt; $P18      Nd146Di        146Nd_CD8     3366        0     3365</span></a>
<a class="sourceLine" id="cb3-35" data-line-number="35"><span class="co">#&gt; $P19      Sm147Di       147Sm_CD20    14397        0    14396</span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="co">#&gt; $P20      Nd148Di       148Nd_CD16     2340        0     2339</span></a>
<a class="sourceLine" id="cb3-37" data-line-number="37"><span class="co">#&gt; $P21      Eu151Di      151Eu_CD123    14973        0    14972</span></a>
<a class="sourceLine" id="cb3-38" data-line-number="38"><span class="co">#&gt; $P22      Eu153Di     153Eu_Bcl-xL    37056        0    37055</span></a>
<a class="sourceLine" id="cb3-39" data-line-number="39"><span class="co">#&gt; $P23      Sm154Di    154Sm_Bax_1B4     8837        0     8836</span></a>
<a class="sourceLine" id="cb3-40" data-line-number="40"><span class="co">#&gt; $P24      Gd155Di       155Gd_CD56     2154        0     2153</span></a>
<a class="sourceLine" id="cb3-41" data-line-number="41"><span class="co">#&gt; $P25      Gd156Di       156Gd_CD14    15853        0    15852</span></a>
<a class="sourceLine" id="cb3-42" data-line-number="42"><span class="co">#&gt; $P26      Gd157Di      157Gd_Bcl-2    29777        0    29776</span></a>
<a class="sourceLine" id="cb3-43" data-line-number="43"><span class="co">#&gt; $P27      Tb159Di      159Tb_CD11c     2290        0     2289</span></a>
<a class="sourceLine" id="cb3-44" data-line-number="44"><span class="co">#&gt; $P28      Gd160Di      160Gd_Mcl-1     1252        0     1251</span></a>
<a class="sourceLine" id="cb3-45" data-line-number="45"><span class="co">#&gt; $P29      Dy161Di       161Dy_cMyc     3241        0     3240</span></a>
<a class="sourceLine" id="cb3-46" data-line-number="46"><span class="co">#&gt; $P30      Dy163Di      163Dy_BFL-1    35013        0    35012</span></a>
<a class="sourceLine" id="cb3-47" data-line-number="47"><span class="co">#&gt; $P31      Ho165Di        165Ho_Bim    28808        0    28807</span></a>
<a class="sourceLine" id="cb3-48" data-line-number="48"><span class="co">#&gt; $P32      Er166Di        166Er_pRb     1595        0     1594</span></a>
<a class="sourceLine" id="cb3-49" data-line-number="49"><span class="co">#&gt; $P33      Er167Di       167Er_CD27      715        0      714</span></a>
<a class="sourceLine" id="cb3-50" data-line-number="50"><span class="co">#&gt; $P34      Er168Di       168Er_PUMA    17910        0    17909</span></a>
<a class="sourceLine" id="cb3-51" data-line-number="51"><span class="co">#&gt; $P35      Tm169Di     169Tm_CD45RA     5446        0     5445</span></a>
<a class="sourceLine" id="cb3-52" data-line-number="52"><span class="co">#&gt; $P36      Er170Di        170Er_CD3    13066        0    13065</span></a>
<a class="sourceLine" id="cb3-53" data-line-number="53"><span class="co">#&gt; $P37      Yb171Di       171Yb_CD66     6918        0     6917</span></a>
<a class="sourceLine" id="cb3-54" data-line-number="54"><span class="co">#&gt; $P38      Yb172Di      172Yb_BCL-W    32300        0    32299</span></a>
<a class="sourceLine" id="cb3-55" data-line-number="55"><span class="co">#&gt; $P39      Yb173Di  173Yb_cCaspase3    10011        0    10010</span></a>
<a class="sourceLine" id="cb3-56" data-line-number="56"><span class="co">#&gt; $P40      Yb174Di        174Yb_p53     3874        0     3873</span></a>
<a class="sourceLine" id="cb3-57" data-line-number="57"><span class="co">#&gt; $P41      Ir191Di       191Ir_DNA1    31341        0    31340</span></a>
<a class="sourceLine" id="cb3-58" data-line-number="58"><span class="co">#&gt; $P42      Ir193Di       193Ir_DNA2    39168        0    39167</span></a>
<a class="sourceLine" id="cb3-59" data-line-number="59"><span class="co">#&gt; $P43      Pt194Di  194Pt_Cisplatin    37287        0    37286</span></a>
<a class="sourceLine" id="cb3-60" data-line-number="60"><span class="co">#&gt; $P44      Pt195Di  195Pt_Cisplatin    37573        0    37572</span></a>
<a class="sourceLine" id="cb3-61" data-line-number="61"><span class="co">#&gt; $P45      Bi209Di       209Bi_CD61    58960        0    58959</span></a>
<a class="sourceLine" id="cb3-62" data-line-number="62"><span class="co">#&gt; $P46       Center             &lt;NA&gt;     6732        0     6731</span></a>
<a class="sourceLine" id="cb3-63" data-line-number="63"><span class="co">#&gt; $P47       Offset             &lt;NA&gt;      670        0      669</span></a>
<a class="sourceLine" id="cb3-64" data-line-number="64"><span class="co">#&gt; $P48        Width             &lt;NA&gt;      325        0      324</span></a>
<a class="sourceLine" id="cb3-65" data-line-number="65"><span class="co">#&gt; $P49     Residual             &lt;NA&gt;      846        0      845</span></a>
<a class="sourceLine" id="cb3-66" data-line-number="66"><span class="co">#&gt; [1] &quot;Read Panel File&quot;</span></a>
<a class="sourceLine" id="cb3-67" data-line-number="67"><span class="co">#&gt; [1] &quot;Checking panel colNames&quot;</span></a>
<a class="sourceLine" id="cb3-68" data-line-number="68"><span class="co">#&gt; [1] &quot;Checking panel values&quot;</span></a>
<a class="sourceLine" id="cb3-69" data-line-number="69"><span class="co">#&gt;  [1] &quot;Eu153Di&quot; &quot;Sm154Di&quot; &quot;Gd157Di&quot; &quot;Gd160Di&quot; &quot;Dy161Di&quot; &quot;Dy163Di&quot; &quot;Ho165Di&quot;</span></a>
<a class="sourceLine" id="cb3-70" data-line-number="70"><span class="co">#&gt;  [8] &quot;Er166Di&quot; &quot;Er168Di&quot; &quot;Yb172Di&quot; &quot;Yb173Di&quot; &quot;Yb174Di&quot; &quot;Y89Di&quot;   &quot;In115Di&quot;</span></a>
<a class="sourceLine" id="cb3-71" data-line-number="71"><span class="co">#&gt; [15] &quot;Pr141Di&quot; &quot;Nd142Di&quot; &quot;Nd143Di&quot; &quot;Nd144Di&quot; &quot;Nd145Di&quot; &quot;Nd146Di&quot; &quot;Sm147Di&quot;</span></a>
<a class="sourceLine" id="cb3-72" data-line-number="72"><span class="co">#&gt; [22] &quot;Nd148Di&quot; &quot;Eu151Di&quot; &quot;Gd155Di&quot; &quot;Gd156Di&quot; &quot;Tb159Di&quot; &quot;Er167Di&quot; &quot;Tm169Di&quot;</span></a>
<a class="sourceLine" id="cb3-73" data-line-number="73"><span class="co">#&gt; [29] &quot;Er170Di&quot; &quot;Yb171Di&quot; &quot;Bi209Di&quot;</span></a>
<a class="sourceLine" id="cb3-74" data-line-number="74"><span class="co">#&gt; NULL</span></a>
<a class="sourceLine" id="cb3-75" data-line-number="75"><span class="co">#&gt; [1] &quot;Formatting Data&quot;</span></a>
<a class="sourceLine" id="cb3-76" data-line-number="76"><span class="co">#&gt; [1] &quot;Completed creating DaFrame Objects&quot;</span></a>
<a class="sourceLine" id="cb3-77" data-line-number="77"></a>
<a class="sourceLine" id="cb3-78" data-line-number="78">  <span class="co">## Cluster the data</span></a>
<a class="sourceLine" id="cb3-79" data-line-number="79">  data<span class="op">$</span>daf=<span class="kw">cluster_data</span>(data<span class="op">$</span>daf,seed,<span class="dt">markers_to_use=</span>data<span class="op">$</span>lineage_markers,clusters_nb)</a>
<a class="sourceLine" id="cb3-80" data-line-number="80"><span class="co">#&gt; o running FlowSOM clustering...</span></a>
<a class="sourceLine" id="cb3-81" data-line-number="81"><span class="co">#&gt; o running ConsensusClusterPlus metaclustering...</span></a></code></pre></div>
</div>
<div id="r-shiny-interface-before-cytofruv-normalisation" class="section level2">
<h2>R-Shiny interface before CytofRUV normalisation</h2>
<p>To examine the batch effects found when comparing CyTOF data from samples replicated across batches, we built an R-Shiny application that exhibits any batch effects present in samples replicated across batches using four different diagnostics plots: Median Protein Expression, Protein Expression Distributions, Clustering Results and Cluster Proportions.</p>
<p>The user needs to select the data to use (before or after normalisation) to visualise the diagnostic plots using the R-Shiny interface. The user can choose to visualise all the data or only a subset of the data which might be advisable for exploratory analysis.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">  <span class="co">## Define parameters to use for R-Shiny</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">  daf=data<span class="op">$</span>daf</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">  md=data<span class="op">$</span>md</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">  seed=<span class="dv">1234</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">  <span class="co"># Number of cells displayed for the Distribution of protein expression plot</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">  n_subset_marker_specific &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7">  </a>
<a class="sourceLine" id="cb4-8" data-line-number="8">  <span class="co"># Running Dimension Reduction -&gt; TSNE &amp; UMAP</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9">  <span class="kw">set.seed</span>(seed)</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">  </a>
<a class="sourceLine" id="cb4-11" data-line-number="11">  <span class="co"># Number of cells for tSNE plots marker specific</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12">  TSNE_subset &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13">  <span class="kw">print</span>(<span class="st">&quot;Running TSNE&quot;</span>)</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">  daf &lt;-<span class="st"> </span>CATALYST<span class="op">::</span><span class="kw">runDR</span>(daf, <span class="dt">dr =</span> <span class="st">&quot;TSNE&quot;</span>, <span class="dt">cells =</span> TSNE_subset)</a>
<a class="sourceLine" id="cb4-15" data-line-number="15">  </a>
<a class="sourceLine" id="cb4-16" data-line-number="16">  <span class="co"># Number of cells for UMAP plots marker specific</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17">  UMAP_subset &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18">  <span class="kw">print</span>(<span class="st">&quot;Running UMAP&quot;</span>)</a>
<a class="sourceLine" id="cb4-19" data-line-number="19">  daf &lt;-<span class="st"> </span><span class="kw">runDR</span>(daf, <span class="st">&quot;UMAP&quot;</span>, <span class="dt">cells =</span> UMAP_subset)</a>
<a class="sourceLine" id="cb4-20" data-line-number="20">  </a>
<a class="sourceLine" id="cb4-21" data-line-number="21">  <span class="co">## Launch Shiny</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22">  <span class="co"># For a subset of the data, define the number of cells for diagnostic plots</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23">  n_subset &lt;-<span class="st"> </span><span class="dv">5000</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24">  sub_daf &lt;-<span class="st"> </span>daf[, <span class="kw">sample</span>(<span class="kw">ncol</span>(daf), n_subset)]</a>
<a class="sourceLine" id="cb4-25" data-line-number="25">  </a>
<a class="sourceLine" id="cb4-26" data-line-number="26">  <span class="co">## For the full dataset: </span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27">  <span class="co"># sub_daf &lt;- daf</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28">  </a>
<a class="sourceLine" id="cb4-29" data-line-number="29">  panel=data<span class="op">$</span>panel</a>
<a class="sourceLine" id="cb4-30" data-line-number="30">  </a>
<a class="sourceLine" id="cb4-31" data-line-number="31">  CytofRUV<span class="op">::</span><span class="kw">launch_Shiny</span>()</a></code></pre></div>
</div>
<div id="cytofruv-normalisation-procedure" class="section level2">
<h2>CytofRUV normalisation procedure</h2>
<p>TThe normalize_data function allow the user to adjust for batch effects with parameter settings for the CytofRUV algorithm, such as which replicated samples to use and the value of k. The user can specify below the name of the directory to save the normalised data (dir_name_norm_data) or use the get_directory function which will ask the user to specify the directory. The normalised files and the metadata and panel files will be save into the specified directory.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co">#dir_name_norm_data = get_directory()</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">dir_name_norm_data=<span class="st">&quot;CytofRUV_Norm_data_HC2_all_cl_20&quot;</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">raw_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sample =</span> data<span class="op">$</span>daf<span class="op">$</span>sample_id, <span class="dt">cluster=</span><span class="kw">cluster_ids</span>(data<span class="op">$</span>daf,<span class="st">&quot;meta20&quot;</span>), <span class="kw">t</span>(SummarizedExperiment<span class="op">::</span><span class="kw">assay</span>(data<span class="op">$</span>daf)))</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw">colnames</span>(raw_data) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;^X&quot;</span>, <span class="st">&quot;&quot;</span>,  <span class="kw">colnames</span>(raw_data))</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">rep_samples=<span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;HC2_B1&quot;</span>,<span class="st">&quot;HC2_B2&quot;</span>))</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">cluster_list_rep_samples &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>))</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">k_value &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8">seed=<span class="dv">1234</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="kw">normalise_data</span>(<span class="dt">data=</span>data,<span class="dt">raw_data=</span>raw_data,<span class="dt">rep_samples=</span>rep_samples, <span class="dt">norm_clusters=</span>cluster_list_rep_samples, <span class="dt">k=</span>k_value, <span class="dt">num_clusters=</span>clusters_nb,<span class="dt">wd_data=</span>wd_data,<span class="dt">dir_norm_data=</span>dir_name_norm_data)</a></code></pre></div>
</div>
<div id="loading-and-clustering-the-data-after-cytofruv-normalisation" class="section level2">
<h2>Loading and clustering the data after CytofRUV normalisation</h2>
<p>The first step is to load the metadata file, all the .fcs files, the panel file from the dataset. The user needs to define the working directory as well as the filename of the metadata file and the panel file. Once the dataset is loaded, after applying an arcsinh transformation (cofactor 5), all the data will be clustered. The user needs to provide the number of clusters to be used for this dataset.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">  <span class="co">## Define parameters to load and cluster the data</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">  wd_norm=<span class="kw">file.path</span>(wd_data,dir_name_norm_data)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  metadata_norm_filename=<span class="st">&quot;Norm_Metadata.xlsx&quot;</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  panel_norm_filename=<span class="st">&quot;Norm_Panel.xlsx&quot;</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  seed=<span class="dv">1234</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">  clusters_nb=<span class="dv">20</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"></a>
<a class="sourceLine" id="cb6-8" data-line-number="8">  <span class="co">## Loading the data</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9">  norm_data=<span class="kw">load_data</span>(wd_norm,metadata_norm_filename,panel_norm_filename,<span class="dt">cofactor =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; [1] &quot;Reading MetaData&quot;</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; [1] &quot;Reading fcs files&quot;</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt;         name            desc    range    minRange maxRange</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; $P1     Time            &lt;NA&gt; 15248628    0.000000 15248627</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; $P2    Y89Di        89Y_CD45     2410 -111.000000     2409</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; $P3  In115Di    115In_HLA-DR     4659 -111.000000     4658</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; $P4  Pr141Di   141Pr_CD235ab    20716  -37.495953    20693</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt; $P5  Nd142Di      142Nd_CD19    12575  -44.284832    24735</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt; $P6  Nd143Di       143Nd_CD5    13286 -111.000000    24618</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt; $P7  Nd144Di      144Nd_CD38     4375 -111.000000    20194</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt; $P8  Nd145Di       145Nd_CD4     1661 -111.000000    23302</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt; $P9  Nd146Di       146Nd_CD8     3366 -111.000000    20907</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt; $P10 Sm147Di      147Sm_CD20    14397  -10.018948    14396</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt; $P11 Nd148Di      148Nd_CD16     2340  -57.073624     2339</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt; $P12 Eu151Di     151Eu_CD123    14973  -32.510345    14972</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt; $P13 Gd155Di      155Gd_CD56     2154  -65.271797     2153</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt; $P14 Gd156Di      156Gd_CD14    15853 -111.000000    15852</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co">#&gt; $P15 Tb159Di     159Tb_CD11c     2290 -111.000000     2289</span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co">#&gt; $P16 Er167Di      167Er_CD27      715  -32.499676      714</span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co">#&gt; $P17 Tm169Di    169Tm_CD45RA     5446 -111.000000     5445</span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#&gt; $P18 Er170Di       170Er_CD3    13066 -111.000000    13065</span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="co">#&gt; $P19 Yb171Di      171Yb_CD66     6918  -61.431759     6917</span></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="co">#&gt; $P20 Bi209Di      209Bi_CD61    58960 -111.000000    58959</span></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="co">#&gt; $P21 Eu153Di    153Eu_Bcl-xL    37056  -28.817259    37055</span></a>
<a class="sourceLine" id="cb6-34" data-line-number="34"><span class="co">#&gt; $P22 Sm154Di   154Sm_Bax_1B4     8837  -91.867622     8836</span></a>
<a class="sourceLine" id="cb6-35" data-line-number="35"><span class="co">#&gt; $P23 Gd157Di     157Gd_Bcl-2    29777 -111.000000    29776</span></a>
<a class="sourceLine" id="cb6-36" data-line-number="36"><span class="co">#&gt; $P24 Gd160Di     160Gd_Mcl-1     1252  -93.262131     1251</span></a>
<a class="sourceLine" id="cb6-37" data-line-number="37"><span class="co">#&gt; $P25 Dy161Di      161Dy_cMyc     3241 -111.000000     3240</span></a>
<a class="sourceLine" id="cb6-38" data-line-number="38"><span class="co">#&gt; $P26 Dy163Di     163Dy_BFL-1    35013  -40.920792    35012</span></a>
<a class="sourceLine" id="cb6-39" data-line-number="39"><span class="co">#&gt; $P27 Ho165Di       165Ho_Bim    28808 -111.000000    28807</span></a>
<a class="sourceLine" id="cb6-40" data-line-number="40"><span class="co">#&gt; $P28 Er166Di       166Er_pRb     1595 -111.000000     1594</span></a>
<a class="sourceLine" id="cb6-41" data-line-number="41"><span class="co">#&gt; $P29 Er168Di      168Er_PUMA    17910 -111.000000    17909</span></a>
<a class="sourceLine" id="cb6-42" data-line-number="42"><span class="co">#&gt; $P30 Yb172Di     172Yb_BCL-W    32300  -33.413170    32299</span></a>
<a class="sourceLine" id="cb6-43" data-line-number="43"><span class="co">#&gt; $P31 Yb173Di 173Yb_cCaspase3    10011  -11.643580    10010</span></a>
<a class="sourceLine" id="cb6-44" data-line-number="44"><span class="co">#&gt; $P32 Yb174Di       174Yb_p53     3874   -3.675655     3873</span></a>
<a class="sourceLine" id="cb6-45" data-line-number="45"><span class="co">#&gt; [1] &quot;Read Panel File&quot;</span></a>
<a class="sourceLine" id="cb6-46" data-line-number="46"><span class="co">#&gt; [1] &quot;Checking panel colNames&quot;</span></a>
<a class="sourceLine" id="cb6-47" data-line-number="47"><span class="co">#&gt; [1] &quot;Checking panel values&quot;</span></a>
<a class="sourceLine" id="cb6-48" data-line-number="48"><span class="co">#&gt;  [1] &quot;Eu153Di&quot; &quot;Sm154Di&quot; &quot;Gd157Di&quot; &quot;Gd160Di&quot; &quot;Dy161Di&quot; &quot;Dy163Di&quot; &quot;Ho165Di&quot;</span></a>
<a class="sourceLine" id="cb6-49" data-line-number="49"><span class="co">#&gt;  [8] &quot;Er166Di&quot; &quot;Er168Di&quot; &quot;Yb172Di&quot; &quot;Yb173Di&quot; &quot;Yb174Di&quot; &quot;Y89Di&quot;   &quot;In115Di&quot;</span></a>
<a class="sourceLine" id="cb6-50" data-line-number="50"><span class="co">#&gt; [15] &quot;Pr141Di&quot; &quot;Nd142Di&quot; &quot;Nd143Di&quot; &quot;Nd144Di&quot; &quot;Nd145Di&quot; &quot;Nd146Di&quot; &quot;Sm147Di&quot;</span></a>
<a class="sourceLine" id="cb6-51" data-line-number="51"><span class="co">#&gt; [22] &quot;Nd148Di&quot; &quot;Eu151Di&quot; &quot;Gd155Di&quot; &quot;Gd156Di&quot; &quot;Tb159Di&quot; &quot;Er167Di&quot; &quot;Tm169Di&quot;</span></a>
<a class="sourceLine" id="cb6-52" data-line-number="52"><span class="co">#&gt; [29] &quot;Er170Di&quot; &quot;Yb171Di&quot; &quot;Bi209Di&quot;</span></a>
<a class="sourceLine" id="cb6-53" data-line-number="53"><span class="co">#&gt; NULL</span></a>
<a class="sourceLine" id="cb6-54" data-line-number="54"><span class="co">#&gt; [1] &quot;Formatting Data&quot;</span></a>
<a class="sourceLine" id="cb6-55" data-line-number="55"><span class="co">#&gt; [1] &quot;Completed creating DaFrame Objects&quot;</span></a>
<a class="sourceLine" id="cb6-56" data-line-number="56"></a>
<a class="sourceLine" id="cb6-57" data-line-number="57">  <span class="co">## Cluster the data</span></a>
<a class="sourceLine" id="cb6-58" data-line-number="58">  norm_data<span class="op">$</span>daf=<span class="kw">cluster_data</span>(norm_data<span class="op">$</span>daf,seed,<span class="dt">markers_to_use=</span>norm_data<span class="op">$</span>lineage_markers,clusters_nb)</a>
<a class="sourceLine" id="cb6-59" data-line-number="59"><span class="co">#&gt; o running FlowSOM clustering...</span></a>
<a class="sourceLine" id="cb6-60" data-line-number="60"><span class="co">#&gt; o running ConsensusClusterPlus metaclustering...</span></a></code></pre></div>
</div>
<div id="r-shiny-interface-after-cytofruv-normalisation" class="section level2">
<h2>R-Shiny interface after CytofRUV normalisation</h2>
<p>The R-shiny interface can also be used to visualise the normalised data.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">  <span class="co">## Define parameters to use for R-Shiny</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">  daf=norm_data<span class="op">$</span>daf</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  md=norm_data<span class="op">$</span>md</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  seed=<span class="dv">1234</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">  <span class="co"># Number of cells for diagnostic plots marker specific</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">  n_subset_marker_specific &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"></a>
<a class="sourceLine" id="cb7-8" data-line-number="8">  <span class="co"># Define type of markers</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9">  daf_type &lt;-<span class="st"> </span>daf[SingleCellExperiment<span class="op">::</span><span class="kw">rowData</span>(daf)<span class="op">$</span>marker_class<span class="op">==</span><span class="st">&quot;type&quot;</span>, ]</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">  daf_state &lt;-<span class="st"> </span>daf[SingleCellExperiment<span class="op">::</span><span class="kw">rowData</span>(daf)<span class="op">$</span>marker_class<span class="op">==</span><span class="st">&quot;state&quot;</span>, ]</a>
<a class="sourceLine" id="cb7-11" data-line-number="11">  sub_daf_state &lt;-<span class="st"> </span>daf_state[, <span class="kw">sample</span>(<span class="kw">ncol</span>(daf_state), n_subset_marker_specific)]</a>
<a class="sourceLine" id="cb7-12" data-line-number="12">  sub_daf_type &lt;-<span class="st"> </span>daf_type[, <span class="kw">sample</span>(<span class="kw">ncol</span>(daf_type), n_subset_marker_specific)]</a>
<a class="sourceLine" id="cb7-13" data-line-number="13">  <span class="co"># Define batch</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14">  batch_ids &lt;-<span class="st"> </span><span class="kw">is.factor</span>(<span class="kw">rep</span>(md<span class="op">$</span>batch, <span class="kw">nrow</span>(daf)))</a>
<a class="sourceLine" id="cb7-15" data-line-number="15">  sampleID_sorted &lt;-<span class="st"> </span>md<span class="op">$</span>sample_id[<span class="kw">order</span>(md<span class="op">$</span>patient_id)]</a>
<a class="sourceLine" id="cb7-16" data-line-number="16">  </a>
<a class="sourceLine" id="cb7-17" data-line-number="17">  <span class="co">## Running Dimension Reduction -&gt; TSNE &amp; UMAP</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18">  <span class="kw">set.seed</span>(seed)</a>
<a class="sourceLine" id="cb7-19" data-line-number="19">  <span class="co"># Number of cells for tSNE plots marker specific</span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20">  TSNE_subset &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21">  <span class="kw">print</span>(<span class="st">&quot;Running TSNE&quot;</span>)</a>
<a class="sourceLine" id="cb7-22" data-line-number="22">  daf &lt;-<span class="st"> </span><span class="kw">runDR</span>(daf, <span class="st">&quot;TSNE&quot;</span>, <span class="dt">cells =</span> TSNE_subset)</a>
<a class="sourceLine" id="cb7-23" data-line-number="23">  </a>
<a class="sourceLine" id="cb7-24" data-line-number="24">  <span class="co"># Number of cells for UMAP plots marker specific</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25">  UMAP_subset &lt;-<span class="st"> </span><span class="dv">2500</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26">  <span class="kw">print</span>(<span class="st">&quot;Running UMAP&quot;</span>)</a>
<a class="sourceLine" id="cb7-27" data-line-number="27">  daf &lt;-<span class="st"> </span><span class="kw">runDR</span>(daf, <span class="st">&quot;UMAP&quot;</span>, <span class="dt">cells =</span> UMAP_subset)</a>
<a class="sourceLine" id="cb7-28" data-line-number="28">  </a>
<a class="sourceLine" id="cb7-29" data-line-number="29">  <span class="co"># Launch Shiny</span></a>
<a class="sourceLine" id="cb7-30" data-line-number="30">  <span class="co"># For a subset of the data, define the number of cells for diagnostic plots</span></a>
<a class="sourceLine" id="cb7-31" data-line-number="31">  n_subset &lt;-<span class="st"> </span><span class="dv">5000</span></a>
<a class="sourceLine" id="cb7-32" data-line-number="32">  sub_daf &lt;-<span class="st"> </span>daf[, <span class="kw">sample</span>(<span class="kw">ncol</span>(daf), n_subset)]</a>
<a class="sourceLine" id="cb7-33" data-line-number="33">  </a>
<a class="sourceLine" id="cb7-34" data-line-number="34">  <span class="co"># # For the full dataset: </span></a>
<a class="sourceLine" id="cb7-35" data-line-number="35">  <span class="co"># sub_daf &lt;- daf</span></a>
<a class="sourceLine" id="cb7-36" data-line-number="36">  </a>
<a class="sourceLine" id="cb7-37" data-line-number="37">  panel=data<span class="op">$</span>panel</a>
<a class="sourceLine" id="cb7-38" data-line-number="38">  </a>
<a class="sourceLine" id="cb7-39" data-line-number="39">  CytofRUV<span class="op">::</span><span class="kw">launch_Shiny</span>()</a></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
